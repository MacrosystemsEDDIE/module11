---
title: "Module 11: Time Series Modeling and Prediction of Environmental Data - Student Handout"
output: 
   word_document:
    reference_docx: report-style.docx
---

```{r setup, include=FALSE}
#options(kableExtra.auto_format = FALSE)
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
time <- Sys.time()

# Read in assessment questions
quest <- read.csv("data/handout_questions.csv", row.names = 1)
module_text <- read.csv("data/module_text.csv", row.names = 1, header = FALSE)

site_tab <- data.frame("Characteristic" = c(substr(quest["q3a", ], 3, nchar(quest["q3a", ])),substr(quest["q3b", ], 3, nchar(quest["q3b", ])),substr(quest["q3c", ], 3, nchar(quest["q3c", ])),substr(quest["q3d", ], 3, nchar(quest["q3d", ])),substr(quest["q3e", ], 3, nchar(quest["q3e", ]))),
                       "Answer" = rep("",5))

env_var_tab <- data.frame("Variable" = rep("",10),
                          "Units" = rep("",10),
                          "Mean" = rep("",10),
                          "Minimum" = rep("",10),
                          "Maximum" = rep("",10))

env_var_rel <- data.frame("Target" = rep("",10),
                          "Variable" = rep("",10),
                          "Relationship" = rep("",10))

model_perf <- data.frame("Model" = c("ARIMA","NNETAR","persistence","DOY"),
                          "RMSE" = rep("",4),
                          "ignorance" = rep("",4))



```

![](www/report-header.png)

***
### Name: 
### Student ID: 
#### Completed on: 
#### Copy-paste your save progress link from the Shiny app here for ease of reference:
***

# **Macrosystems EDDIE Module 11: Time Series Modeling and Prediction of Environmental Data**


# Learning Objectives:

In the course of this module, you will:

- Explore relationships between ecological variables from environmental case studies.
- Understand the structure of four time series models (including machine learning models) that are commonly applied in environmental science.
- Fit time series models using environmental data and assess the importance of ecological driver variables in making model predictions.
- Process environmental datasets into standardized formats suitable for training and assessing time series models.
- Compare multiple time series models to assess their performance on out-of-sample predictions.



# Summary:

Advances in environmental sensor technology in recent decades permit collection of environmental data at high temporal frequencies (e.g., every 10 minutes) across many ecosystems. These time series of environmental data can be used to gain information about the previous and current state of ecosystems, as well as make predictions about ecosystem states in the future. To help researchers and managers understand the complex patterns that can occur in high-frequency time series data, time series models are commonly applied in ecology and environmental science. These models use statistical and machine learning methods to identify signals in high-frequency environmental data.

In this module, students will apply several different time series and machine learning models to environmental data. They will explore data from an environmental case study of their choice, choose which environmental variables to use to fit a time series model, assess the model, and use it to make predictions. Then, they will process a new dataset into a standardized format, upload it into the module, and fit several other models to compare predictive performance across models. They will also evaluate the ecological implications that can be drawn from each model (e.g., which variables are important for explaining the dynamics of the target variable for prediction).

## Module overview:

- Introduce concepts related to time series modeling and environmental data case studies
- Activity A: Visualize data from a selected environmental data case study and fit and assess a time series model
- Activity B: Choose a new environmental dataset or upload your own dataset and fit and assess a time series model
- Activity C: Fit additional time series models to your environmental dataset and compare performance across models


## Today's focal question: _How can we use time series models to understand and predict the state of ecosystems?_

To address this question, we will introduce several time series models that are commonly applied in ecology and environmental science. We will also introduce the importance of using standardized datasets and out-of-sample prediction to train and assess time series models. We will fit a model that predicts a target variable that is important for ecosystem management. We will make out-of-sample predictions with this model to assess model fit, also examine the uncertainty associated with our predictions. Then, we will format and upload a standardized dataset and fit several models to generate out-of-sample predictions for an environmental case study that is relevant to your coursework. Finally, we will compare performance across models and draw inference regarding which ecological variables are important for predicting the target variable of management concern.
  
We will be using ecological data collected by the Swan-Canning Estuary Virtual Observatory (SCEVO) in Western Australia and the National Ecological Observation Network (NEON) in the United STates to tackle this question. SCEVO is a monitoring network to observe water quality in the Swan and Canning Rivers in Perth, Australia, which are important drinking water supplies. NEON is a continental-scale observatory designed to collect publicly-available, long-term ecological data to monitor changing ecosystems across the U.S. 

Our focal target variable for the SCEVO dataset will be chlorophyll-a, a measure of aquatic primary productivity. Chlorophyll-a is an important ecosystem variable because it can indicate when a harmful algal bloom is occurring. High levels of chlorophyll-a may indicate a bloom, which can have deleterious effects on water quality through release of toxins, formation of surface scums, and depletion of dissolved oxygen in the water. 

The target variable for the NEON dataset will be net ecosystem exchange (NEE), a measure of carbon dioxide flux from ecosystems. NEE indicates whether an ecosystem is emitting or taking up greenhouse gasses, and how this changes over time.
  
  
## R Shiny App:

The lesson content is hosted on an R Shiny App at [https://macrosystemseddie.shinyapps.io/module11/](https://macrosystemseddie.shinyapps.io/module11/)  
This can be accessed via any internet browser and allows you to navigate through the lesson via this app. You will fill in the questions below on this handout as you complete the lesson activities.

## Optional pre-class readings and videos:

- Tredennick, A. T., Hooker, G., Ellner, S. P., & Adler, P. B. (2021). A practical guide to selecting models for exploration, inference, and prediction in ecology. Ecology, 102(6), e03336. [https://doi.org/10.1002/ecy.3336](https://doi.org/10.1002/ecy.3336)

- Wickham, H., Çetinkaya-Rundel, M., and Grolemund, G. (2023) R for Data Science (2nd ed.), [Chapter 5: Data Tidying.](https://r4ds.hadley.nz/data-tidy.html)
\

\newpage

## Pre-class activity: Explore environmental case study
Choose one of the papers describing an environmental case study and use it to answer the questions below. Choose the case study that you will work with for Activity A of the module.
\

**Phytoplankton dynamics in the Canning River, Western Australia**
Huang, P., Trayler, K., Wang, B., Saeed, A., Oldham, C. E., Busch, B., & Hipsey, M. R. (2019). An integrated modelling system for water quality forecasting in an urban eutrophic estuary: The Swan-Canning Estuary virtual observatory. Journal of Marine Systems, 199, 103218. [https://doi.org/10.1016/j.jmarsys.2019.103218](https://doi.org/10.1016/j.jmarsys.2019.103218)

**Net ecosystem exchange in Bartlett Experimental Forest, NH, USA**
Jung, Chang Gyo, and Oleksandra Hararuk. "Assimilation of NEON observations into a process‐based carbon cycle model reveals divergent mechanisms of carbon dynamics in temperate deciduous forests." Journal of Geophysical Research: Biogeosciences 127.3 (2022): e2021JG006474.
[https://doi.org/10.1029/2021JG006474](https://doi.org/10.1029/2021JG006474)

\

#### Pre-class questions: Choose one of the environmental case studies above and use the paper to answer the questions below. 
\
A.  Which case study did you select?  

**Answer:** 

\    
B.  What ecological variable(s) are being predicted?  

**Answer:** 

\
C.  How can these predictions help the public and/or managers?

**Answer:** 

\
D.  Describe the way(s) in which the model predictions are assessed (evaluated for accuracy).

**Answer:** 

\

\newpage

# Introduction

Now navigate to the [Shiny interface](https://macrosystemseddie.shinyapps.io/module11) to answer the rest of the questions.

The questions you must answer are written both in the Shiny interface as well as in this handout. As you go, you should fill out your answers in this document.

## Think about it!
\
Answer the following questions:

1. `r substr(quest["q1", ], 4, nchar(quest["q1", ]))`  
\
**Answer:** 
\

2. `r substr(quest["q2", ], 4, nchar(quest["q2", ]))`   
\
**Answer:** 
\


# Activity A: Select an environmental case study, visualize data, and fit a model

## Objective 1: Select case study\

***
`r module_text["obj_01", ]`

***

3. `r substr(quest["q3", ], 4, nchar(quest["q3", ]))`  
\
*Table 1. Site Characteristics*
```{r}
knitr::kable(site_tab) 
```

4. `r substr(quest["q4", ], 4, nchar(quest["q4", ]))`
\
**Answer:**
\


## Objective 2: Explore data

***
`r module_text["obj_02", ]`

***

5. `r substr(quest["q5", ], 4, nchar(quest["q5", ]))`
\
*Table 2. Description of site variables:*  

```{r}
knitr::kable(env_var_tab) 
```
\

6. `r substr(quest["q6", ], 4, nchar(quest["q6", ]))`
\
*Table 3. Description of effect of each variable on the target variable*  

```{r}
knitr::kable(env_var_rel) 
```
\


## Objective 3: Learn about ARIMA model\

***
`r module_text["obj_03", ]`

***

7. `r substr(quest["q7", ], 4, nchar(quest["q7", ]))`
\
**Answer:**
\

8. `r substr(quest["q8", ], 4, nchar(quest["q8", ]))`
\
**Answer:**
\

**Please download the plot associated with Q8 and copy-paste it into your report below.**

*Figure 1. Target variable vs. one-day lag of environmental case study target variable*  

9. `r substr(quest["q9", ], 4, nchar(quest["q9", ]))`
\
**Answer:**
\

**Please download the plot associated with Q9 and copy-paste it into your report below.**

*Figure 2. Partial autocorrelation of environmental case study target variable*  

10. `r substr(quest["q10", ], 5, nchar(quest["q10", ]))`
\
**Answer:**
\

**Please download the plot associated with Q10 and copy-paste it into your report below.**

*Figure 3. Differenced time series of environmental case study target variable*  


## Objective 4: Fit model\

***
`r module_text["obj_04", ]`

***

11. `r substr(quest["q11", ], 5, nchar(quest["q11", ]))` 
\
**Answer:**
\

12. `r substr(quest["q12", ], 5, nchar(quest["q12", ]))`  
\
    a.  `r substr(quest["q12a", ], 4, nchar(quest["q12a", ]))`:   
    \
    **Answer:**
    \
    b.  `r substr(quest["q12b", ], 4, nchar(quest["q12b", ]))`:   
    \
    **Answer:**
    \
    c.  `r substr(quest["q12c", ], 4, nchar(quest["q12c", ]))`:   
    \
    **Answer:**
    \
    d.  `r substr(quest["q12d", ], 4, nchar(quest["q12d", ]))`:   
    \
    **Answer:**
    \
\

13. `r substr(quest["q13", ], 5, nchar(quest["q13", ]))` 
\
**Answer:**
\

14. `r substr(quest["q14", ], 5, nchar(quest["q14", ]))` 
\
**Answer:**
\

15. `r substr(quest["q15", ], 5, nchar(quest["q15", ]))` 
\
**Answer:**
\


## Objective 5: Assess model fit\

***
`r module_text["obj_05", ]`

***

16. `r substr(quest["q16", ], 5, nchar(quest["q16", ]))`
\
**Answer:**
\

**Please download the plot associated with Q16 and copy-paste it into your report below.**

*Figure 4. ARIMA predictions of out-of-sample observations of the environmental case study target variable* 

17. `r substr(quest["q17", ], 5, nchar(quest["q17", ]))`
\
**Answer:**
\

18. `r substr(quest["q18", ], 5, nchar(quest["q18", ]))`
\
**Answer:**
\

19. `r substr(quest["q19", ], 5, nchar(quest["q19", ]))`
\
**Answer:**
\

**Please download the plot associated with Q19 and copy-paste it into your report below.**

*Figure 5. ARIMA predictions with uncertainty of out-of-sample observations of the environmental case study target variable*

20. `r substr(quest["q20", ], 5, nchar(quest["q20", ]))`
\
**Answer:**
\

\newpage

# Activity B: Upload your own data and fit a time series model

## Objective 6: Upload standardized data\

***
`r module_text["obj_06", ]`

***

24. `r substr(quest["q24", ], 6, nchar(quest["q24", ]))`  
\
**Answer:** 
\

25. `r substr(quest["q25", ], 6, nchar(quest["q25", ]))`  
\
**Answer:** 
\

26. `r substr(quest["q26", ], 6, nchar(quest["q26", ]))`
\
    a.  `r substr(quest["q26a", ], 3, nchar(quest["q26a", ]))`  
    \
    **Answer:**  
    \
    b.  `r substr(quest["q26b", ], 3, nchar(quest["q26b", ]))`  
    \
    **Answer:**   
    \
    c.  `r substr(quest["q26c", ], 3, nchar(quest["q26c", ]))`  
    \
    **Answer:**   
    \
    d.  `r substr(quest["q26d", ], 3, nchar(quest["q26d", ]))`  
    \
    **Answer:**   
    \
\


## Objective 7: Fit an ARIMA model to your standardized dataset\

***
`r module_text["obj_07", ]`

***

27. `r substr(quest["q27", ], 6, nchar(quest["q27", ]))`  
\
**Answer:** 
\

28. `r substr(quest["q28", ], 6, nchar(quest["q28", ]))`  
\
**Answer:** 
\

29. `r substr(quest["q29", ], 6, nchar(quest["q29", ]))`  
\
**Answer:** 
\

30. `r substr(quest["q30", ], 6, nchar(quest["q30", ]))`
\
    a.  `r substr(quest["q30a", ], 3, nchar(quest["q30a", ]))`  
    \
    **Answer:**  
    \
    b.  `r substr(quest["q30b", ], 3, nchar(quest["q30b", ]))`  
    \
    **Answer:**   
    \
    c.  `r substr(quest["q30c", ], 3, nchar(quest["q30c", ]))`  
    \
    **Answer:**   
    \
    d.  `r substr(quest["q30d", ], 3, nchar(quest["q30d", ]))`  
    \
    **Answer:**   
    \
\

31. `r substr(quest["q31", ], 6, nchar(quest["q31", ]))`  
\
**Answer:** 
\


## Objective 8: Assess model fit\

***
`r module_text["obj_08", ]`

***

32. `r substr(quest["q32", ], 6, nchar(quest["q32", ]))`  
\
**Answer:** 
\

**Please download the plot associated with Q32 and copy-paste it into your report below.**

*Figure 6. ARIMA predictions with uncertainty of out-of-sample observations of the standardized dataset target variable*

33. `r substr(quest["q33", ], 6, nchar(quest["q33", ]))`  
\
**Answer:** 
\

\newpage

# Activity C: Compare predictive performance across models

## Objective 9: Fit additional models\

***
`r module_text["obj_09", ]`

***

34. `r substr(quest["q34", ], 6, nchar(quest["q34", ]))`
\
    a.  `r substr(quest["q34a", ], 3, nchar(quest["q34a", ]))`  
    \
    **Answer:**  
    \
    b.  `r substr(quest["q34b", ], 3, nchar(quest["q34b", ]))`  
    \
    **Answer:**   
    \
    c.  `r substr(quest["q34c", ], 3, nchar(quest["q34c", ]))`  
    \
    **Answer:**   
    \
\

35. `r substr(quest["q35", ], 6, nchar(quest["q35", ]))`  
\
**Answer:** 
\

36. `r substr(quest["q36", ], 6, nchar(quest["q36", ]))`  
\
**Answer:** 
\

37. `r substr(quest["q37", ], 6, nchar(quest["q37", ]))`  
\
**Answer:** 
\

**Please download the plot associated with Q37 and copy-paste it into your report below.**

*Figure 7. ARIMA, NNETAR, persistence, and DOY model fits for the standardized dataset target variable*


## Objective 10: Compare model performance\

***
`r module_text["obj_10", ]`

***

38. `r substr(quest["q38", ], 6, nchar(quest["q38", ]))`  
\
**Answer:** 
\

**Please download the plot associated with Q38 and copy-paste it into your report below.**

*Figure 8. Distributions of the residuals of ARIMA, NNETAR, persistence, and DOY model fits for the standardized dataset target variable*

39. `r substr(quest["q39", ], 6, nchar(quest["q39", ]))`  
\
**Answer:** 
\

40. `r substr(quest["q40", ], 6, nchar(quest["q40", ]))`  
\
**Answer:** 
\

**Please download the plot associated with Q40 and copy-paste it into your report below.**

*Figure 9. Predictions with uncertainty of ARIMA, NNETAR, persistence, and DOY models fit to the standardized dataset target variable*

41. `r substr(quest["q41", ], 6, nchar(quest["q41", ]))`  
\
**Answer:** 
\

42. `r substr(quest["q42", ], 6, nchar(quest["q42", ]))`  
\
*Table 4. RMSE and ignorance score of the ARIMA, NNETAR, persistence, and DOY models*
```{r}
knitr::kable(model_perf) 
```
\

43. `r substr(quest["q43", ], 6, nchar(quest["q43", ]))`  
\
**Answer:** 
\

44. `r substr(quest["q44", ], 6, nchar(quest["q44", ]))`  
\
**Answer:** 
\

45. `r substr(quest["q45", ], 6, nchar(quest["q45", ]))`  
\
**Answer:** 
\

This module was developed by Lofton, M.E., M.H. Hipsey, K. Kurucz, and C.C. Carey. 31 July 2025. Macrosystems EDDIE: Time Series Modeling and Prediction of Environmental Data. Macrosystems EDDIE Module 11, Version 1. http://module11.macrosystemseddie.org. Module development was supported by NSF grants EF 1702506, 1926050, 2318861, DEB 2213550, and OISE 2330211.

This document last modified: 31 July 2025 by MEL.
